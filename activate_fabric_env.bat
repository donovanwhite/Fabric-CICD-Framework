@echo off
REM =============================================================================
REM Activate Fabric CICD Environment - fabric-cicd
REM =============================================================================
REM This file is auto-generated by setup_fabric_cicd.bat
REM To regenerate: run setup_fabric_cicd.bat

echo ğŸš€ Activating Fabric CICD environment: fabric-cicd...
call conda activate fabric-cicd
if errorlevel 1 (
    echo âŒ Failed to activate environment
    echo ğŸ’¡ Run setup_fabric_cicd.bat to create the environment
    pause
    exit /b 1
)

echo âœ… Environment activated successfully!
echo ğŸ’¡ You can now run Fabric CICD commands
echo.
if exist "%USERPROFILE%\Miniconda3\Scripts\activate.bat" (
    call "%USERPROFILE%\Miniconda3\Scripts\activate.bat" fabric-cicd
    if %errorlevel%==0 (
        echo âœ… Successfully activated using user profile Miniconda3
        goto :success
    )
)

REM If all attempts fail
echo âŒ Could not activate fabric-cicd environment
echo.
echo ğŸ’¡ Please try one of these solutions:
echo    1. Make sure conda is added to your PATH
echo    2. Create the environment manually: conda create -n fabric-cicd python=3.12.11
echo    3. Run this from an Anaconda Prompt instead
echo.
pause
exit /b 1

:success

REM Show environment info
echo âœ… Environment activated!
echo ğŸ“‹ Environment: fabric-cicd
echo ğŸ Python version:
python --version
echo.

REM Test fabric-cicd availability
echo ğŸ§ª Testing fabric-cicd installation...
python test_environment.py

echo.
echo ğŸ¯ You're now ready to use Fabric CICD!
echo.
echo ğŸ“š Available scripts:
echo    python fabric_deploy_local.py --help    # Deploy from local repository
echo    python fabric_deploy_devops.py --help   # Deploy from Azure DevOps
echo    deploy_from_devops.bat                   # Interactive DevOps deployment
echo.
echo ğŸ’¡ To deactivate: conda deactivate
echo.

REM Keep the command prompt open in the activated environment
cmd /k
